<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Crypto Toolbox ‚Äî Full Single File</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- CryptoJS -->
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/crypto-js.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/md5.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/sha1.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/sha256.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/sha3.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/crypto-js@4.1.1/ripemd160.js"></script>

  <style>
    body { background:#f8fafc; font-family: Inter, sans-serif; }
    [data-theme="dark"] { background:#0d1117; color:#e6edf3; }
    .card { border-radius: 12px; box-shadow:0 4px 16px rgba(0,0,0,0.08); }
    .monos { font-family: ui-monospace, monospace; }
    .cipher-output { white-space: pre-wrap; word-break: break-word; }
  </style>
</head>
<body>
<div class="container py-4">
  <header class="d-flex mb-4 align-items-center">
    <h1 class="h4 me-3">üîê Crypto Toolbox</h1>
    <div class="ms-auto">
      <div class="form-check form-switch">
        <input class="form-check-input" id="darkModeToggle" type="checkbox">
        <label class="form-check-label" for="darkModeToggle">Dark</label>
      </div>
    </div>
  </header>

  <!-- Password Generator -->
  <section class="card p-3 mb-4">
    <h5>Password & Identity Generator</h5>
    <div class="mb-2 d-flex gap-2">
      <input id="wordCount" type="number" class="form-control form-control-sm" value="5" min="2" max="12" style="width:100px">
      <button id="genPw" class="btn btn-primary btn-sm">Generate</button>
      <button id="copyPw" class="btn btn-outline-secondary btn-sm">Copy</button>
    </div>
    <div id="pwOut" class="p-2 border rounded monos"></div>
    <small id="pwInfo" class="text-muted d-block mt-1"></small>
    <div class="progress mt-2"><div id="pwBar" class="progress-bar" style="width:0%"></div></div>
  </section>

  <!-- Email Merger -->
  <section class="card p-3 mb-4">
    <h5>Email Merger</h5>
    <div class="input-group mb-2">
      <input id="origEmail" type="email" class="form-control" placeholder="alpha@gmail.com">
      <button id="genEmails" class="btn btn-secondary">Generate</button>
    </div>
    <div id="emailOut" class="monos"></div>
  </section>

  <!-- RSA Keys -->
  <section class="card p-3 mb-4">
    <h5>RSA Keys</h5>
    <div class="mb-2">
      <button id="genRSA" class="btn btn-primary btn-sm">Generate</button>
      <input id="rsaMessage" class="form-control mt-2" placeholder="Message">
      <button id="rsaEncrypt" class="btn btn-success btn-sm mt-2">Encrypt</button>
      <button id="rsaDecrypt" class="btn btn-danger btn-sm mt-2">Decrypt</button>
    </div>
    <div id="rsaOut" class="cipher-output monos border p-2"></div>
  </section>

  <!-- AES -->
  <section class="card p-3 mb-4">
    <h5>AES Text Encryption</h5>
    <input id="aesKey" class="form-control mb-2" placeholder="Password">
    <textarea id="aesText" class="form-control mb-2" placeholder="Text"></textarea>
    <button id="aesEncrypt" class="btn btn-primary btn-sm">Encrypt</button>
    <button id="aesDecrypt" class="btn btn-secondary btn-sm">Decrypt</button>
    <div id="aesOut" class="cipher-output monos border p-2 mt-2"></div>
  </section>

  <!-- File -->
  <section class="card p-3 mb-4">
    <h5>File Encryption + SHA-256 Fingerprint</h5>
    <input type="file" id="fileInput" class="form-control mb-2">
    <input id="filePass" class="form-control mb-2" placeholder="Password">
    <button id="fileEncrypt" class="btn btn-primary btn-sm">Encrypt</button>
    <button id="fileDecrypt" class="btn btn-secondary btn-sm">Decrypt</button>
    <div id="fileHash" class="monos mt-2"></div>
  </section>

  <!-- Hash -->
  <section class="card p-3 mb-4">
    <h5>Hashing</h5>
    <textarea id="hashInput" class="form-control mb-2" placeholder="Enter text"></textarea>
    <button id="doHash" class="btn btn-primary btn-sm">Hash</button>
    <input type="file" id="hashFile" class="form-control mt-2">
    <div id="hashOut" class="monos mt-2"></div>
  </section>

  <!-- Stego -->
  <section class="card p-3 mb-4">
    <h5>Image Steganography</h5>
    <input type="file" id="stegoImg" class="form-control mb-2">
    <input id="stegoPass" class="form-control mb-2" placeholder="Password">
    <textarea id="stegoMsg" class="form-control mb-2" placeholder="Message"></textarea>
    <button id="stegoHide" class="btn btn-primary btn-sm">Hide</button>
    <button id="stegoReveal" class="btn btn-secondary btn-sm">Reveal</button>
    <div id="stegoOut" class="monos mt-2"></div>
  </section>
</div>

<script>
// Dark mode
document.getElementById("darkModeToggle").addEventListener("change",e=>{
  document.body.dataset.theme = e.target.checked?"dark":"light";
});

// Helper random words
const words=["alpha","bravo","charlie","delta","echo","foxtrot","golf","hotel","india","juliet","kilo","lima","mike","november","oscar","papa","quebec","romeo","sierra","tango","uniform","victor","whiskey","xray","yankee","zulu","lunacy","ceremony","kisser","cannon","devalue"];
function genPassphrase(n){
  let arr=[];
  for(let i=0;i<n;i++) arr.push(words[Math.floor(Math.random()*words.length)]);
  return arr.join("-");
}
function crackTime(len){return Math.pow(26,len)/1e9;}

// Password gen
document.getElementById("genPw").onclick=()=>{
  let n=parseInt(document.getElementById("wordCount").value)||5;
  let pw=genPassphrase(n);
  document.getElementById("pwOut").textContent=pw;
  let t=crackTime(n*6);
  document.getElementById("pwInfo").textContent=`Estimated crack time: ${t.toExponential(2)} seconds`;
  document.getElementById("pwBar").style.width=Math.min(100,n*10)+"%";
};
document.getElementById("copyPw").onclick=()=>{
  navigator.clipboard.writeText(document.getElementById("pwOut").textContent);
};

// Email merger
document.getElementById("genEmails").onclick=()=>{
  let email=document.getElementById("origEmail").value;
  if(!email.includes("@")) return;
  let [name,domain]=email.split("@");
  let rand=Math.random().toString(36).slice(2,10);
  document.getElementById("emailOut").textContent=`${name}+${rand}@${domain}`;
};

// RSA using WebCrypto
let rsaKeyPair;
async function genRSAKeys(){
  rsaKeyPair=await crypto.subtle.generateKey(
    {name:"RSA-OAEP",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:"SHA-256"},
    true,["encrypt","decrypt"]);
}
document.getElementById("genRSA").onclick=async()=>{await genRSAKeys();document.getElementById("rsaOut").textContent="Keys generated";};
document.getElementById("rsaEncrypt").onclick=async()=>{
  let msg=document.getElementById("rsaMessage").value;
  let enc=await crypto.subtle.encrypt({name:"RSA-OAEP"},rsaKeyPair.publicKey,new TextEncoder().encode(msg));
  document.getElementById("rsaOut").textContent=btoa(String.fromCharCode(...new Uint8Array(enc)));
};
document.getElementById("rsaDecrypt").onclick=async()=>{
  let data=document.getElementById("rsaOut").textContent;
  let bytes=Uint8Array.from(atob(data),c=>c.charCodeAt(0));
  let dec=await crypto.subtle.decrypt({name:"RSA-OAEP"},rsaKeyPair.privateKey,bytes);
  document.getElementById("rsaOut").textContent=new TextDecoder().decode(dec);
};

// AES
document.getElementById("aesEncrypt").onclick=()=>{
  let key=document.getElementById("aesKey").value;
  let text=document.getElementById("aesText").value;
  let enc=CryptoJS.AES.encrypt(text,key).toString();
  document.getElementById("aesOut").textContent=enc;
};
document.getElementById("aesDecrypt").onclick=()=>{
  let key=document.getElementById("aesKey").value;
  let ct=document.getElementById("aesOut").textContent;
  let dec=CryptoJS.AES.decrypt(ct,key);
  try{
    document.getElementById("aesOut").textContent=dec.toString(CryptoJS.enc.Utf8)||"AES decryption failed";
  }catch{document.getElementById("aesOut").textContent="AES decryption failed";}
};

// File
document.getElementById("fileEncrypt").onclick=()=>{
  let file=document.getElementById("fileInput").files[0]; if(!file) return;
  let reader=new FileReader();
  reader.onload=()=>{
    let key=document.getElementById("filePass").value;
    let enc=CryptoJS.AES.encrypt(reader.result,key).toString();
    let hash=CryptoJS.SHA256(reader.result).toString();
    document.getElementById("fileHash").textContent="SHA-256: "+hash;
  };
  reader.readAsText(file);
};
document.getElementById("fileDecrypt").onclick=()=>{
  let file=document.getElementById("fileInput").files[0]; if(!file) return;
  let reader=new FileReader();
  reader.onload=()=>{
    let key=document.getElementById("filePass").value;
    let dec=CryptoJS.AES.decrypt(reader.result,key);
    document.getElementById("fileHash").textContent="Decrypted: "+dec.toString(CryptoJS.enc.Utf8);
  };
  reader.readAsText(file);
};

// Hash
document.getElementById("doHash").onclick=()=>{
  let txt=document.getElementById("hashInput").value;
  let out="MD5: "+CryptoJS.MD5(txt).toString()+"\n";
  out+="SHA1: "+CryptoJS.SHA1(txt).toString()+"\n";
  out+="SHA256: "+CryptoJS.SHA256(txt).toString()+"\n";
  out+="SHA3: "+CryptoJS.SHA3(txt).toString()+"\n";
  out+="RIPEMD160: "+CryptoJS.RIPEMD160(txt).toString();
  document.getElementById("hashOut").textContent=out;
};
document.getElementById("hashFile").onchange=e=>{
  let f=e.target.files[0]; if(!f) return;
  let r=new FileReader();
  r.onload=()=>{
    document.getElementById("hashOut").textContent="SHA256(file): "+CryptoJS.SHA256(r.result).toString();
  };
  r.readAsText(f);
};

// Stego (simple base64 with password)
document.getElementById("stegoHide").onclick=()=>{
  let msg=document.getElementById("stegoMsg").value;
  let pass=document.getElementById("stegoPass").value;
  let hidden=btoa(pass+":"+msg);
  document.getElementById("stegoOut").textContent=hidden;
};
document.getElementById("stegoReveal").onclick=()=>{
  let enc=document.getElementById("stegoOut").textContent;
  let pass=document.getElementById("stegoPass").value;
  try{
    let dec=atob(enc);
    if(dec.startsWith(pass+":"))
      document.getElementById("stegoOut").textContent=dec.slice(pass.length+1);
    else document.getElementById("stegoOut").textContent="Wrong password";
  }catch{document.getElementById("stegoOut").textContent="Invalid data";}
};
</script>
</body>
</html>