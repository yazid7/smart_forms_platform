<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crypto Toolbox</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      background: #f9fafb;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem;
      color: #1f2937;
    }
    .container {
      max-width: 1000px;
      width: 100%;
      background: white;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1), 0 1px 2px rgba(0,0,0,0.06);
      padding: 2rem;
    }
    h1 {
      text-align: center;
      font-size: 2rem;
      font-weight: 700;
      color: #1f2937;
      margin-bottom: 2rem;
      position: relative;
    }
    h1::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background: #3b82f6;
      border-radius: 3px;
    }
    section {
      margin-bottom: 2.5rem;
      background: white;
      border-radius: 0.75rem;
      box-shadow: 0 1px 3px 0 rgba(0,0,0,0.1), 0 1px 2px 0 rgba(0,0,0,0.06);
      padding: 1.5rem;
    }
    h2 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: #1f2937;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    h2 svg {
      width: 1.5rem;
      height: 1.5rem;
    }
    .section-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }
    .form-group {
      margin-bottom: 1rem;
    }
    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: #4b5563;
    }
    input, textarea, select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #d1d5db;
      border-radius: 0.375rem;
      font-size: 1rem;
      transition: border-color 0.2s;
    }
    input:focus, textarea:focus, select:focus {
      border-color: #3b82f6;
      outline: none;
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
    }
    textarea {
      min-height: 100px;
      resize: vertical;
    }
    .password-container {
      display: flex;
      border-radius: 0.375rem;
      overflow: hidden;
      box-shadow: 0 1px 2px 0 rgba(0,0,0,0.05);
      margin-bottom: 1rem;
    }
    .password-container input {
      flex: 1;
      border: 1px solid #d1d5db;
      border-right: none;
      padding: 0.75rem;
      font-size: 1rem;
      outline: none;
    }
    .password-container button {
      background: #f3f4f6;
      border: none;
      cursor: pointer;
      padding: 0.75rem;
      transition: background 0.2s;
      width: 60px;
    }
    .password-container button:hover {
      background: #e5e7eb;
    }
    .btn {
      display: inline-block;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 0.375rem;
      padding: 0.75rem 1.25rem;
      font-weight: 500;
      cursor: pointer;
      transition: background 0.2s;
      width: 100%;
      margin-top: 0.5rem;
    }
    .btn:hover {
      background: #2563eb;
    }
    .btn:disabled {
      background: #d1d5db;
      cursor: not-allowed;
    }
    .btn-secondary {
      background: #64748b;
    }
    .btn-secondary:hover {
      background: #475569;
    }
    .btn-success {
      background: #10b981;
    }
    .btn-success:hover {
      background: #059669;
    }
    .btn-warning {
      background: #f59e0b;
    }
    .btn-warning:hover {
      background: #e69400;
    }
    .btn-danger {
      background: #ef4444;
    }
    .btn-danger:hover {
      background: #dc2626;
    }
    .result-container {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 0.375rem;
      padding: 1rem;
      margin-top: 1rem;
    }
    .result-value {
      font-family: monospace;
      background: #f3f4f6;
      padding: 0.75rem;
      border-radius: 0.25rem;
      overflow-x: auto;
      font-size: 0.875rem;
      margin: 0.5rem 0;
      word-break: break-all;
    }
    .morse-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    .morse-table th, .morse-table td {
      border: 1px solid #e5e7eb;
      padding: 0.5rem;
      text-align: center;
    }
    .morse-table th {
      background: #f3f4f6;
      font-weight: 600;
    }
    .steganography-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .steganography-image {
      max-width: 100%;
      max-height: 300px;
      display: block;
      margin: 0 auto;
      border-radius: 0.25rem;
      border: 1px solid #e5e7eb;
    }
    .algorithms-notes {
      line-height: 1.6;
      white-space: pre-line;
    }
    .tabs {
      display: flex;
      margin-bottom: 1rem;
      border-bottom: 1px solid #e5e7eb;
    }
    .tab {
      padding: 0.75rem 1.5rem;
      cursor: pointer;
      font-weight: 500;
      color: #64748b;
      border-bottom: 3px solid transparent;
    }
    .tab.active {
      color: #3b82f6;
      border-bottom: 3px solid #3b82f6;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .email-check {
      display: flex;
      gap: 0.5rem;
    }
    .email-check input {
      flex: 1;
    }
    .email-check .btn {
      width: auto;
    }
    .email-result {
      margin-top: 0.5rem;
      padding: 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.875rem;
    }
    .email-valid {
      background: #dcfce7;
      color: #166534;
    }
    .email-invalid {
      background: #fee2e2;
      color: #b91c1c;
    }
    .key-pair-container {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .key-display {
      background: #f3f4f6;
      padding: 1rem;
      border-radius: 0.25rem;
      font-family: monospace;
      font-size: 0.875rem;
      white-space: pre-wrap;
      word-break: break-all;
    }
    .file-upload {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    .file-upload label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      padding: 0.75rem;
      border: 1px dashed #d1d5db;
      border-radius: 0.375rem;
      background: #f9fafb;
      text-align: center;
    }
    .file-upload label:hover {
      background: #f3f4f6;
    }
    .file-upload label svg {
      width: 1.5rem;
      height: 1.5rem;
      color: #64748b;
    }
    .file-upload input {
      display: none;
    }
    .file-name {
      font-size: 0.875rem;
      color: #4b5563;
      margin-top: 0.5rem;
    }
    .file-name span {
      color: #3b82f6;
      cursor: pointer;
      transition: color 0.2s;
    }
    .file-name span:hover {
      text-decoration: underline;
    }
    .copy-btn {
      background: #f3f4f6;
      border: none;
      cursor: pointer;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.875rem;
      transition: background 0.2s;
    }
    .copy-btn:hover {
      background: #e5e7eb;
    }
    .copy-btn svg {
      width: 1rem;
      height: 1rem;
    }
    .hash-comparison {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .hash-comparison input {
      flex: 1;
    }
    .hash-comparison .btn {
      width: auto;
    }
    .match-status {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }
    .match-status .icon {
      width: 1.25rem;
      height: 1.25rem;
    }
    .match-status .icon.match {
      color: #10b981;
    }
    .match-status .icon.nomatch {
      color: #ef4444;
    }
    .steganography-controls {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    .steganography-controls .btn {
      flex: 1;
    }
    .steganography-result {
      margin-top: 1rem;
      padding: 1rem;
      background: #f3f4f6;
      border-radius: 0.25rem;
      font-family: monospace;
      font-size: 0.875rem;
    }
    .steganography-result.hidden {
      display: none;
    }
    .morse-converter {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .morse-converter textarea {
      min-height: 100px;
    }
    .morse-converter .morse-output {
      background: #f3f4f6;
      padding: 1rem;
      border-radius: 0.25rem;
      font-family: monospace;
      white-space: pre-wrap;
      word-break: break-all;
    }
    .morse-converter .morse-output span {
      display: inline-block;
      margin: 0 0.25rem;
    }
    .morse-table-container {
      overflow-x: auto;
    }
    .algorithm-section {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .algorithm-card {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 0.5rem;
      padding: 1rem;
    }
    .algorithm-card h3 {
      margin-bottom: 0.5rem;
      color: #3b82f6;
    }
    .algorithm-card p {
      line-height: 1.6;
    }
    .algorithm-card code {
      background: #f3f4f6;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-family: monospace;
    }
    .algorithm-card ul {
      padding-left: 1.5rem;
      margin-top: 0.5rem;
    }
    .algorithm-card li {
      margin-bottom: 0.25rem;
    }
    .tabs-container {
      margin-top: 1rem;
    }
    .tabs-container .tab-content {
      padding: 1rem;
      background: #f9fafb;
      border-radius: 0.5rem;
      border: 1px solid #e5e7eb;
    }
    .tabs-container .tab-content.active {
      display: block;
    }
    .tabs-container .tab-content code {
      display: block;
      background: #f3f4f6;
      padding: 1rem;
      border-radius: 0.25rem;
      font-family: monospace;
      overflow-x: auto;
    }
    .file-encryption-section {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .file-encryption-controls {
      display: flex;
      gap: 0.5rem;
    }
    .file-encryption-controls .btn {
      flex: 1;
    }
    .file-encryption-preview {
      max-width: 100%;
      max-height: 200px;
      display: block;
      margin: 0 auto;
      border-radius: 0.25rem;
      border: 1px solid #e5e7eb;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Crypto Toolbox</h1>
    
    <section>
      <h2>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
          <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
        </svg>
        File Encryption (AES-CBC via CryptoJS) + SHA-256 fingerprint
      </h2>
      <div class="file-encryption-section">
        <div class="file-upload">
          <label for="encryptFile">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            Upload File for Encryption
          </label>
          <input type="file" id="encryptFile" accept="*">
          <div class="file-name" id="encryptFileName">No file selected</div>
        </div>
        <div class="form-group">
          <label for="encryptKey">Encryption Key (16/24/32 characters)</label>
          <input type="text" id="encryptKey" placeholder="Enter encryption key">
        </div>
        <div class="form-group">
          <label for="encryptIV">Initialization Vector (IV) (16 characters)</label>
          <input type="text" id="encryptIV" placeholder="Enter IV (16 characters)">
        </div>
        <div class="file-encryption-controls">
          <button class="btn" id="encryptBtn">Encrypt File</button>
          <button class="btn btn-secondary" id="decryptBtn">Decrypt File</button>
        </div>
        <div class="result-container">
          <div class="result-value" id="encryptedData"></div>
          <button class="copy-btn" onclick="copyToClipboard('encryptedData')">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            Copy
          </button>
        </div>
        <div class="form-group">
          <label for="fileHash">SHA-256 Fingerprint</label>
          <input type="text" id="fileHash" readonly>
        </div>
        <div class="form-group" id="decryptedFilePreviewContainer" style="display: none;">
          <label>Decrypted File Preview</label>
          <img id="decryptedFilePreview" class="file-encryption-preview" src="" alt="Decrypted file preview">
        </div>
      </div>
    </section>

    <section>
      <h2>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        Public / Private Key (RSA-OAEP)
      </h2>
      <div class="key-pair-container">
        <button class="btn" id="generateKeysBtn">Generate RSA Key Pair</button>
        <div class="result-container">
          <div class="result-value" id="publicKeyDisplay"></div>
          <button class="copy-btn" onclick="copyToClipboard('publicKeyDisplay')">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            Copy Public Key
          </button>
        </div>
        <div class="result-container">
          <div class="result-value" id="privateKeyDisplay"></div>
          <button class="copy-btn" onclick="copyToClipboard('privateKeyDisplay')">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            Copy Private Key
          </button>
        </div>
      </div>
      <div class="form-group">
        <label for="rsaEncryptText">Text to Encrypt</label>
        <textarea id="rsaEncryptText" placeholder="Enter text to encrypt..."></textarea>
      </div>
      <button class="btn" id="rsaEncryptBtn">Encrypt with Public Key</button>
      <div class="result-container">
        <div class="result-value" id="rsaEncryptedData"></div>
        <button class="copy-btn" onclick="copyToClipboard('rsaEncryptedData')">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
          </svg>
          Copy Encrypted Data
        </button>
      </div>
      <div class="form-group">
        <label for="rsaDecryptText">Encrypted Text</label>
        <textarea id="rsaDecryptText" placeholder="Enter encrypted text..."></textarea>
      </div>
      <button class="btn" id="rsaDecryptBtn">Decrypt with Private Key</button>
      <div class="result-container">
        <div class="result-value" id="rsaDecryptedData"></div>
      </div>
    </section>

    <section>
      <h2>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        Text Encryption / Hash / Comparison
      </h2>
      <div class="tabs">
        <div class="tab active" data-tab="hash">Hash</div>
        <div class="tab" data-tab="encrypt">Encrypt</div>
        <div class="tab" data-tab="compare">Compare</div>
      </div>
      <div class="tabs-container">
        <div class="tab-content active" id="hashTab">
          <div class="form-group">
            <label for="hashText">Text to Hash</label>
            <textarea id="hashText" placeholder="Enter text to hash..."></textarea>
          </div>
          <div class="form-group">
            <label for="hashAlgorithm">Algorithm</label>
            <select id="hashAlgorithm">
              <option value="SHA-256">SHA-256</option>
              <option value="SHA-1">SHA-1</option>
              <option value="MD5">MD5</option>
            </select>
          </div>
          <button class="btn" id="calculateHashBtn">Calculate Hash</button>
          <div class="result-container">
            <div class="result-value" id="hashResult"></div>
            <button class="copy-btn" onclick="copyToClipboard('hashResult')">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
              Copy Hash
            </button>
          </div>
        </div>
        <div class="tab-content" id="encryptTab">
          <div class="form-group">
            <label for="encryptText">Text to Encrypt</label>
            <textarea id="encryptText" placeholder="Enter text to encrypt..."></textarea>
          </div>
          <div class="form-group">
            <label for="encryptKeyText">Encryption Key</label>
            <input type="text" id="encryptKeyText" placeholder="Enter encryption key">
          </div>
          <button class="btn" id="encryptTextBtn">Encrypt Text</button>
          <div class="result-container">
            <div class="result-value" id="encryptedTextResult"></div>
            <button class="copy-btn" onclick="copyToClipboard('encryptedTextResult')">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
              </svg>
              Copy Encrypted Text
            </button>
          </div>
        </div>
        <div class="tab-content" id="compareTab">
          <div class="hash-comparison">
            <input type="text" id="hash1" placeholder="Hash 1">
            <input type="text" id="hash2" placeholder="Hash 2">
          </div>
          <button class="btn" id="compareHashBtn">Compare Hashes</button>
          <div class="match-status">
            <svg id="matchIcon" class="icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
            <span id="matchResult">No comparison done yet</span>
          </div>
        </div>
      </div>
    </section>

    <section>
      <h2>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"></path>
          <path d="M12 6v6l4 2"></path>
        </svg>
        Image Steganography (LSB) â€” AES protected payload
      </h2>
      <div class="steganography-container">
        <div class="file-upload">
          <label for="stegoImage">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="17 8 12 3 7 8"></polyline>
              <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
            Upload Image
          </label>
          <input type="file" id="stegoImage" accept="image/*">
          <div class="file-name" id="stegoImageName">No image selected</div>
        </div>
        <div class="form-group">
          <label for="stegoMessage">Message to Hide</label>
          <textarea id="stegoMessage" placeholder="Enter message to hide in image..."></textarea>
        </div>
        <div class="form-group">
          <label for="stegoKey">AES Encryption Key</label>
          <input type="text" id="stegoKey" placeholder="Enter encryption key">
        </div>
        <div class="steganography-controls">
          <button class="btn" id="embedBtn">Embed Message</button>
          <button class="btn btn-secondary" id="extractBtn">Extract Message</button>
        </div>
        <div class="steganography-result" id="stegoResult">
          <img id="stegoImagePreview" class="steganography-image" src="https://placehold.co/400x300" alt="Image preview">
          <div id="stegoMessageOutput" class="result-value"></div>
        </div>
      </div>
    </section>

    <section>
      <h2>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M18 8h-1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-10a2 2 0 0 0-2-2h-1"></path>
          <rect x="2" y="2" width="20" height="20" rx="2" ry="2"></rect>
          <line x1="10" y1="10" x2="14" y2="10"></line>
          <line x1="10" y1="14" x2="14" y2="14"></line>
          <line x1="10" y1="18" x2="14" y2="18"></line>
        </svg>
        Algorithms & Notes
      </h2>
      <div class="algorithm-section">
        <div class="algorithm-card">
          <h3>AES-CBC</h3>
          <p>Advanced Encryption Standard in Cipher Block Chaining mode. Requires a key and initialization vector (IV). The IV must be randomly generated for each encryption operation and shared with the recipient for decryption.</p>
          <code>const encrypted = CryptoJS.AES.encrypt(plaintext, key, { iv: iv, mode: CryptoJS.mode.CBC });</code>
        </div>
        <div class="algorithm-card">
          <h3>RSA-OAEP</h3>
          <p>RSA encryption with Optimal Asymmetric Encryption Padding. Provides strong security for public-key encryption. Used for encrypting small amounts of data like symmetric keys.</p>
          <code>const encrypted = await crypto.subtle.encrypt({ name: 'RSA-OAEP' }, publicKey, data);</code>
        </div>
        <div class="algorithm-card">
          <h3>LSB Steganography</h3>
          <p>Least Significant Bit steganography hides data in the least significant bits of image pixels. AES encryption is used to protect the payload before embedding.</p>
          <code>const stegoImage = embedMessageInImage(originalImage, encryptedMessage);</code>
        </div>
        <div class="algorithm-card">
          <h3>SHA-256/SHA-1/MD5</h3>
          <p>Hashing algorithms used for data integrity verification. SHA-256 is currently considered secure for most applications.</p>
          <code>const hash = CryptoJS.SHA256(data).toString();</code>
        </div>
      </div>
    </section>

    <section>
      <h2>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
          <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
        </svg>
        Morse code (extended)
      </h2>
      <div class="morse-converter">
        <div class="form-group">
          <label for="morseInput">Text to Morse</label>
          <textarea id="morseInput" placeholder="Enter text to convert to Morse code..."></textarea>
        </div>
        <button class="btn" id="convertMorseBtn">Convert to Morse</button>
        <div class="morse-output" id="morseOutput"></div>
        <div class="form-group">
          <label for="morseReverseInput">Morse to Text</label>
          <textarea id="morseReverseInput" placeholder="Enter Morse code (use space between letters, / for word)"></textarea>
        </div>
        <button class="btn" id="reverseMorseBtn">Convert to Text</button>
        <div class="morse-output" id="morseReverseOutput"></div>
      </div>
      <div class="morse-table-container">
        <table class="morse-table">
          <thead>
            <tr>
              <th>Char</th>
              <th>Morse</th>
              <th>Char</th>
              <th>Morse</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>A</td>
              <td>.-</td>
              <td>N</td>
              <td>-. </td>
            </tr>
            <tr>
              <td>B</td>
              <td>-...</td>
              <td>O</td>
              <td>---</td>
            </tr>
            <tr>
              <td>C</td>
              <td>-.-.</td>
              <td>P</td>
              <td>.--.</td>
            </tr>
            <tr>
              <td>D</td>
              <td>-..</td>
              <td>Q</td>
              <td>--.-</td>
            </tr>
            <tr>
              <td>E</td>
              <td>.</td>
              <td>R</td>
              <td>.-. </td>
            </tr>
            <tr>
              <td>F</td>
              <td>..-.</td>
              <td>S</td>
              <td>...</td>
            </tr>
            <tr>
              <td>G</td>
              <td>--.</td>
              <td>T</td>
              <td>-</td>
            </tr>
            <tr>
              <td>H</td>
              <td>....</td>
              <td>U</td>
              <td>..-</td>
            </tr>
            <tr>
              <td>I</td>
              <td>..</td>
              <td>V</td>
              <td>...-</td>
            </tr>
            <tr>
              <td>J</td>
              <td>.---</td>
              <td>W</td>
              <td>.--</td>
            </tr>
            <tr>
              <td>K</td>
              <td>-.-</td>
              <td>X</td>
              <td>-..-</td>
            </tr>
            <tr>
              <td>L</td>
              <td>.-..</td>
              <td>Y</td>
              <td>-.--</td>
            </tr>
            <tr>
              <td>M</td>
              <td>--</td>
              <td>Z</td>
              <td>--..</td>
            </tr>
            <tr>
              <td>0</td>
              <td>-----</td>
              <td>5</td>
              <td>.....</td>
            </tr>
            <tr>
              <td>1</td>
              <td>.----</td>
              <td>6</td>
              <td>-....</td>
            </tr>
            <tr>
              <td>2</td>
              <td>..---</td>
              <td>7</td>
              <td>--...</td>
            </tr>
            <tr>
              <td>3</td>
              <td>...--</td>
              <td>8</td>
              <td>---..</td>
            </tr>
            <tr>
              <td>4</td>
              <td>....-</td>
              <td>9</td>
              <td>----.</td>
            </tr>
            <tr>
              <td>.</td>
              <td>.-.-.-</td>
              <td>,</td>
              <td>--..--</td>
            </tr>
            <tr>
              <td>?</td>
              <td>..--..</td>
              <td>'</td>
              <td>.----.</td>
            </tr>
            <tr>
              <td>!</td>
              <td>-.-.--</td>
              <td>/</td>
              <td>-..-.</td>
            </tr>
            <tr>
              <td>(</td>
              <td>-.--.</td>
              <td>)</td>
              <td>-.--.-</td>
            </tr>
            <tr>
              <td>&</td>
              <td>.-...</td>
              <td>:</td>
              <td>---...</td>
            </tr>
            <tr>
              <td>;</td>
              <td>-.-.-.</td>
              <td>=</td>
              <td>-...-</td>
            </tr>
            <tr>
              <td>+</td>
              <td>.-.-.</td>
              <td>-</td>
              <td>-....-</td>
            </tr>
            <tr>
              <td>_</td>
              <td>..--.-</td>
              <td>"</td>
              <td>.-..-.</td>
            </tr>
            <tr>
              <td>$</td>
              <td>...-..-</td>
              <td>@</td>
              <td>.--.-.</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section>
      <h2>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h6z"></path>
          <path d="M8 12h8"></path>
          <path d="M8 16h4"></path>
          <path d="M8 8h4"></path>
        </svg>
        Password leak helper & email check (simulated)
      </h2>
      <div class="password-container">
        <input type="password" id="passwordInput" readonly placeholder="Generated password will appear here">
        <button id="showHideBtn">Show</button>
        <button id="copyBtn">Copy</button>
        <button id="clearBtn">Clear</button>
      </div>
      <button class="btn" id="generatePasswordBtn">Generate Strong Password</button>
      <div class="email-check">
        <input type="email" id="emailCheck" placeholder="Enter email to check">
        <button class="btn" id="checkEmailBtn">Check Email</button>
      </div>
      <div class="email-result" id="emailResult"></div>
    </section>
  </div>

  <script>
    // CryptoJS functions
    function encryptFile() {
      const fileInput = document.getElementById('encryptFile');
      const keyInput = document.getElementById('encryptKey');
      const ivInput = document.getElementById('encryptIV');
      const encryptedDataElement = document.getElementById('encryptedData');
      const fileHashElement = document.getElementById('fileHash');
      const decryptedFilePreviewContainer = document.getElementById('decryptedFilePreviewContainer');
      const decryptedFilePreview = document.getElementById('decryptedFilePreview');
      
      if (!fileInput.files.length) {
        alert('Please select a file');
        return;
      }
      
      if (!keyInput.value || keyInput.value.length < 16) {
        alert('Encryption key must be at least 16 characters');
        return;
      }
      
      const key = CryptoJS.enc.Utf8.parse(keyInput.value);
      const iv = ivInput.value ? CryptoJS.enc.Utf8.parse(ivInput.value) : CryptoJS.lib.WordArray.random(16);
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const fileData = e.target.result;
        const encrypted = CryptoJS.AES.encrypt(fileData, key, { iv: iv, mode: CryptoJS.mode.CBC });
        encryptedDataElement.textContent = encrypted.toString();
        
        // Calculate SHA-256 fingerprint
        const hash = CryptoJS.SHA256(fileData).toString();
        fileHashElement.value = hash;
        
        // Clear decrypted preview
        decryptedFilePreviewContainer.style.display = 'none';
        decryptedFilePreview.src = '';
      };
      reader.readAsArrayBuffer(fileInput.files[0]);
    }

    function decryptFile() {
      const fileInput = document.getElementById('encryptFile');
      const keyInput = document.getElementById('encryptKey');
      const ivInput = document.getElementById('encryptIV');
      const encryptedDataElement = document.getElementById('encryptedData');
      const decryptedFilePreviewContainer = document.getElementById('decryptedFilePreviewContainer');
      const decryptedFilePreview = document.getElementById('decryptedFilePreview');
      
      if (!fileInput.files.length) {
        alert('Please select a file');
        return;
      }
      
      if (!keyInput.value || keyInput.value.length < 16) {
        alert('Encryption key must be at least 16 characters');
        return;
      }
      
      const key = CryptoJS.enc.Utf8.parse(keyInput.value);
      const iv = ivInput.value ? CryptoJS.enc.Utf8.parse(ivInput.value) : CryptoJS.lib.WordArray.random(16);
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const fileData = e.target.result;
        
        // Attempt to decrypt
        try {
          const decrypted = CryptoJS.AES.decrypt(fileData, key, { iv: iv, mode: CryptoJS.mode.CBC });
          const decryptedText = decrypted.toString(CryptoJS.enc.Utf8);
          
          // Try to display as image if possible
          if (fileInput.files[0].type.startsWith('image/')) {
            const base64Data = btoa(decryptedText);
            const imgSrc = `data:${fileInput.files[0].type};base64,${base64Data}`;
            decryptedFilePreview.src = imgSrc;
            decryptedFilePreviewContainer.style.display = 'block';
          } else {
            encryptedDataElement.textContent = decryptedText;
          }
        } catch (error) {
          alert('Decryption failed. Please check your key and IV.');
        }
      };
      reader.readAsText(fileInput.files[0]);
    }

    // RSA-OAEP functions
    async function generateKeys() {
      const keyPair = await crypto.subtle.generateKey(
        {
          name: 'RSA-OAEP',
          modulusLength: 2048,
          publicExponent: new Uint8Array([1, 0, 1]),
          hash: { name: 'SHA-256' }
        },
        true,
        ['encrypt', 'decrypt']
      );
      
      const publicKey = await crypto.subtle.exportKey('spki', keyPair.publicKey);
      const privateKey = await crypto.subtle.exportKey('pkcs8', keyPair.privateKey);
      
      const publicKeyBase64 = btoa(String.fromCharCode(...new Uint8Array(publicKey)));
      const privateKeyBase64 = btoa(String.fromCharCode(...new Uint8Array(privateKey)));
      
      document.getElementById('publicKeyDisplay').textContent = publicKeyBase64;
      document.getElementById('privateKeyDisplay').textContent = privateKeyBase64;
    }

    async function encryptWithRSA() {
      const text = document.getElementById('rsaEncryptText').value;
      const publicKeyBase64 = document.getElementById('publicKeyDisplay').textContent;
      
      if (!text || !publicKeyBase64) {
        alert('Please provide text and public key');
        return;
      }
      
      const publicKeyBuffer = Uint8Array.from(atob(publicKeyBase64), c => c.charCodeAt(0));
      const publicKey = await crypto.subtle.importKey(
        'spki',
        publicKeyBuffer,
        { name: 'RSA-OAEP', hash: { name: 'SHA-256' } },
        true,
        ['encrypt']
      );
      
      const encoder = new TextEncoder();
      const data = encoder.encode(text);
      const encrypted = await crypto.subtle.encrypt({ name: 'RSA-OAEP' }, publicKey, data);
      
      const encryptedBase64 = btoa(String.fromCharCode(...new Uint8Array(encrypted)));
      document.getElementById('rsaEncryptedData').textContent = encryptedBase64;
    }

    async function decryptWithRSA() {
      const encryptedText = document.getElementById('rsaDecryptText').value;
      const privateKeyBase64 = document.getElementById('privateKeyDisplay').textContent;
      
      if (!encryptedText || !privateKeyBase64) {
        alert('Please provide encrypted text and private key');
        return;
      }
      
      const privateKeyBuffer = Uint8Array.from(atob(privateKeyBase64), c => c.charCodeAt(0));
      const privateKey = await crypto.subtle.importKey(
        'pkcs8',
        privateKeyBuffer,
        { name: 'RSA-OAEP', hash: { name: 'SHA-256' } },
        true,
        ['decrypt']
      );
      
      const encryptedBuffer = Uint8Array.from(atob(encryptedText), c => c.charCodeAt(0));
      const decrypted = await crypto.subtle.decrypt({ name: 'RSA-OAEP' }, privateKey, encryptedBuffer);
      
      const decoder = new TextDecoder();
      document.getElementById('rsaDecryptedData').textContent = decoder.decode(decrypted);
    }

    // Hash functions
    function calculateHash() {
      const text = document.getElementById('hashText').value;
      const algorithm = document.getElementById('hashAlgorithm').value;
      
      if (!text) {
        alert('Please enter text to hash');
        return;
      }
      
      let hash;
      if (algorithm === 'SHA-256') {
        hash = CryptoJS.SHA256(text).toString();
      } else if (algorithm === 'SHA-1') {
        hash = CryptoJS.SHA1(text).toString();
      } else if (algorithm === 'MD5') {
        hash = CryptoJS.MD5(text).toString();
      }
      
      document.getElementById('hashResult').textContent = hash;
    }

    // Text encryption
    function encryptText() {
      const text = document.getElementById('encryptText').value;
      const key = document.getElementById('encryptKeyText').value;
      
      if (!text || !key) {
        alert('Please enter text and key');
        return;
      }
      
      const encrypted = CryptoJS.AES.encrypt(text, key).toString();
      document.getElementById('encryptedTextResult').textContent = encrypted;
    }

    // Hash comparison
    function compareHashes() {
      const hash1 = document.getElementById('hash1').value;
      const hash2 = document.getElementById('hash2').value;
      
      if (!hash1 || !hash2) {
        alert('Please enter both hashes');
        return;
      }
      
      const match = hash1 === hash2;
      const icon = document.getElementById('matchIcon');
      const resultText = document.getElementById('matchResult');
      
      if (match) {
        icon.classList.add('match');
        icon.classList.remove('nomatch');
        resultText.textContent = 'Hashes match!';
      } else {
        icon.classList.add('nomatch');
        icon.classList.remove('match');
        resultText.textContent = 'Hashes do not match';
      }
    }

    // Steganography functions
    function embedMessageInImage() {
      const imageInput = document.getElementById('stegoImage');
      const messageInput = document.getElementById('stegoMessage');
      const keyInput = document.getElementById('stegoKey');
      const imagePreview = document.getElementById('stegoImagePreview');
      const resultOutput = document.getElementById('stegoMessageOutput');
      
      if (!imageInput.files.length) {
        alert('Please select an image');
        return;
      }
      
      if (!messageInput.value) {
        alert('Please enter a message to hide');
        return;
      }
      
      if (!keyInput.value) {
        alert('Please enter an encryption key');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const img = new Image();
        img.src = e.target.result;
        img.onload = function() {
          const canvas = document.createElement('canvas');
          canvas.width = img.width;
          canvas.height = img.height;
          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0);
          
          // Encrypt message
          const encryptedMessage = CryptoJS.AES.encrypt(messageInput.value, keyInput.value).toString();
          
          // Embed message in image (LSB)
          const data = ctx.getImageData(0, 0, canvas.width, canvas.height);
          const messageBytes = new TextEncoder().encode(encryptedMessage);
          
          // Add null terminator
          const terminator = new Uint8Array([0]);
          const fullMessage = new Uint8Array(messageBytes.length + terminator.length);
          fullMessage.set(messageBytes);
          fullMessage.set(terminator, messageBytes.length);
          
          let index = 0;
          for (let i = 0; i < data.data.length && index < fullMessage.length; i += 4) {
            // Modify the red channel
            data.data[i] = (data.data[i] & 0xFE) | ((fullMessage[index] >> 7) & 1);
            // Modify the green channel
            data.data[i + 1] = (data.data[i + 1] & 0xFE) | ((fullMessage[index] >> 6) & 1);
            // Modify the blue channel
            data.data[i + 2] = (data.data[i + 2] & 0xFE) | ((fullMessage[index] >> 5) & 1);
            // Modify the alpha channel
            data.data[i + 3] = (data.data[i + 3] & 0xFE) | ((fullMessage[index] >> 4) & 1);
            
            index++;
          }
          
          ctx.putImageData(data, 0, 0);
          imagePreview.src = canvas.toDataURL();
          resultOutput.textContent = 'Message embedded successfully';
          resultOutput.classList.remove('hidden');
        };
      };
      reader.readAsDataURL(imageInput.files[0]);
    }

    function extractMessageFromImage() {
      const imageInput = document.getElementById('stegoImage');
      const keyInput = document.getElementById('stegoKey');
      const resultOutput = document.getElementById('stegoMessageOutput');
      
      if (!imageInput.files.length) {
        alert('Please select an image');
        return;
      }
      
      if (!keyInput.value) {
        alert('Please enter an encryption key');
        return;
      }
      
      const reader = new FileReader();
      reader.onload = function(e) {
        const img = new Image();
        img.src = e.target.result;
        img.onload = function() {
          const canvas = document.createElement('canvas');
          canvas.width = img.width;
          canvas.height = img.height;
          const ctx = canvas.getContext('2d');
          ctx.drawImage(img, 0, 0);
          
          const data = ctx.getImageData(0, 0, canvas.width, canvas.height);
          let extractedBytes = [];
          let foundTerminator = false;
          
          for (let i = 0; i < data.data.length && !foundTerminator; i += 4) {
            // Extract bits from each channel
            const bit1 = data.data[i] & 1;
            const bit2 = (data.data[i + 1] & 1) << 1;
            const bit3 = (data.data[i + 2] & 1) << 2;
            const bit4 = (data.data[i + 3] & 1) << 3;
            
            const byte = bit1 | bit2 | bit3 | bit4;
            extractedBytes.push(byte);
            
            // Check for null terminator
            if (byte === 0) {
              foundTerminator = true;
              break;
            }
          }
          
          // Convert to string
          const extractedText = new TextDecoder().decode(new Uint8Array(extractedBytes));
          
          // Decrypt message
          try {
            const decrypted = CryptoJS.AES.decrypt(extractedText, keyInput.value).toString(CryptoJS.enc.Utf8);
            resultOutput.textContent = decrypted;
            resultOutput.classList.remove('hidden');
          } catch (e) {
            resultOutput.textContent = 'Failed to decrypt message. Check your key.';
            resultOutput.classList.remove('hidden');
          }
        };
      };
      reader.readAsDataURL(imageInput.files[0]);
    }

    // Morse code functions
    const morseCodeMap = {
      'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.', 'G': '--.', 'H': '....',
      'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..', 'M': '--', 'N': '-.', 'O': '---', 'P': '.--.',
      'Q': '--.-', 'R': '.-.', 'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',
      'Y': '-.--', 'Z': '--..', '0': '-----', '1': '.----', '2': '..---', '3': '...--', '4': '....-',
      '5': '.....', '6': '-....', '7': '--...', '8': '---..', '9': '----.', '.': '.-.-.-', ',': '--..--',
      '?': '..--..', "'": '.----.', '!': '-.-.--', '/': '-..-.', '(': '-.--.', ')': '-.--.-', '&': '.-...',
      ':': '---...', ';': '-.-.-.', '=': '-...-', '+': '.-.-.', '-': '-....-', '_': '..--.-', '"': '.-..-.',
      '$': '...-..-', '@': '.--.-.', ' ': '/'
    };

    const reverseMorseMap = Object.fromEntries(Object.entries(morseCodeMap).map(([k, v]) => [v, k]));

    function convertToMorse() {
      const input = document.getElementById('morseInput').value.toUpperCase();
      let morse = '';
      
      for (const char of input) {
        if (morseCodeMap[char]) {
          morse += morseCodeMap[char] + ' ';
        } else {
          morse += '? ';
        }
      }
      
      document.getElementById('morseOutput').textContent = morse.trim();
    }

    function convertToText() {
      const input = document.getElementById('morseReverseInput').value;
      const words = input.split(' / ');
      let text = '';
      
      for (const word of words) {
        const chars = word.split(' ');
        for (const char of chars) {
          if (reverseMorseMap[char]) {
            text += reverseMorseMap[char];
          } else {
            text += '?';
          }
        }
        text += ' ';
      }
      
      document.getElementById('morseReverseOutput').textContent = text.trim();
    }

    // Password generation
    function generatePassword() {
      const length = 16;
      const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*()';
      let password = '';
      for (let i = 0; i < length; i++) {
        password += characters.charAt(Math.floor(Math.random() * characters.length));
      }
      document.getElementById('passwordInput').value = password;
      document.getElementById('passwordInput').type = 'text';
      document.getElementById('showHideBtn').textContent = 'Hide';
    }

    function togglePasswordVisibility() {
      const passwordInput = document.getElementById('passwordInput');
      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        document.getElementById('showHideBtn').textContent = 'Hide';
      } else {
        passwordInput.type = 'password';
        document.getElementById('showHideBtn').textContent = 'Show';
      }
    }

    function copyPassword() {
      const passwordInput = document.getElementById('passwordInput');
      if (passwordInput.value) {
        navigator.clipboard.writeText(passwordInput.value).then(() => {
          const originalText = document.getElementById('copyBtn').textContent;
          document.getElementById('copyBtn').textContent = 'Copied!';
          setTimeout(() => {
            document.getElementById('copyBtn').textContent = originalText;
          }, 2000);
        });
      }
    }

    function clearPassword() {
      document.getElementById('passwordInput').value = '';
      document.getElementById('passwordInput').type = 'password';
      document.getElementById('showHideBtn').textContent = 'Show';
    }

    // Email check
    function checkEmail() {
      const email = document.getElementById('emailCheck').value;
      const resultElement = document.getElementById('emailResult');
      
      if (!email) {
        resultElement.textContent = 'Please enter an email address';
        resultElement.className = 'email-result email-invalid';
        return;
      }
      
      // Simulated email check (no real API)
      const isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
      
      if (isValid) {
        resultElement.textContent = 'Email is valid';
        resultElement.className = 'email-result email-valid';
      } else {
        resultElement.textContent = 'Email is invalid';
        resultElement.className = 'email-result email-invalid';
      }
    }

    // Tab switching
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        
        tab.classList.add('active');
        const tabId = tab.getAttribute('data-tab');
        document.getElementById(`${tabId}Tab`).classList.add('active');
      });
    });

    // File name display
    function updateFileName(inputId, displayId) {
      const input = document.getElementById(inputId);
      const display = document.getElementById(displayId);
      
      if (input.files.length) {
        display.textContent = input.files[0].name;
      } else {
        display.textContent = 'No file selected';
      }
    }

    // Event listeners
    document.getElementById('encryptFile').addEventListener('change', () => updateFileName('encryptFile', 'encryptFileName'));
    document.getElementById('stegoImage').addEventListener('change', () => updateFileName('stegoImage', 'stegoImageName'));
    
    document.getElementById('encryptBtn').addEventListener('click', encryptFile);
    document.getElementById('decryptBtn').addEventListener('click', decryptFile);
    
    document.getElementById('generateKeysBtn').addEventListener('click', generateKeys);
    document.getElementById('rsaEncryptBtn').addEventListener('click', encryptWithRSA);
    document.getElementById('rsaDecryptBtn').addEventListener('click', decryptWithRSA);
    
    document.getElementById('calculateHashBtn').addEventListener('click', calculateHash);
    document.getElementById('encryptTextBtn').addEventListener('click', encryptText);
    document.getElementById('compareHashBtn').addEventListener('click', compareHashes);
    
    document.getElementById('embedBtn').addEventListener('click', embedMessageInImage);
    document.getElementById('extractBtn').addEventListener('click', extractMessageFromImage);
    
    document.getElementById('convertMorseBtn').addEventListener('click', convertToMorse);
    document.getElementById('reverseMorseBtn').addEventListener('click', convertToText);
    
    document.getElementById('generatePasswordBtn').addEventListener('click', generatePassword);
    document.getElementById('showHideBtn').addEventListener('click', togglePasswordVisibility);
    document.getElementById('copyBtn').addEventListener('click', copyPassword);
    document.getElementById('clearBtn').addEventListener('click', clearPassword);
    document.getElementById('checkEmailBtn').addEventListener('click', checkEmail);
    
    // Copy to clipboard helper
    function copyToClipboard(elementId) {
      const element = document.getElementById(elementId);
      if (element) {
        navigator.clipboard.writeText(element.textContent).then(() => {
          const copyBtn = element.nextElementSibling;
          if (copyBtn) {
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'Copied!';
            setTimeout(() => {
              copyBtn.textContent = originalText;
            }, 2000);
          }
        });
      }
    }
  </script>
</body>
</html>